---
layout: page
title: 《Web前端开发最佳实践》第十二章 引用12
fullview: false
---

<p>《Web前端开发最佳实践》第十二章 引用12：Responsive Web Design</p>
<p>来源：<a title="http://alistapart.com/article/responsive-web-design" href="http://alistapart.com/article/responsive-web-design">http://alistapart.com/article/responsive-web-design</a></p>
<p>building’s foundation defines its footprint, which defines its frame, which shapes the facade. Each phase of the architectural process is more immutable, more unchanging than the last. Creative decisions quite literally shape a physical space, defining the way in which people move through its confines for decades or even centuries.</p>
<div class="main-content">
<p>Working on the web, however, is a wholly different matter. Our work is defined by its transience, often refined or replaced within a year or two. Inconsistent window widths, screen resolutions, user preferences, and our users’ installed fonts are but a few of the intangibles we negotiate when we publish our work, and over the years, we’ve become incredibly adept at doing so.</p>
<p>But the landscape is shifting, perhaps more quickly than we might like. Mobile browsing is expected to outpace desktop-based access within <a href="http://www.mediapost.com/publications/?fa=Articles.showArticle&amp;art_aid=120590">three</a> to <a href="http://www.morganstanley.com/institutional/techresearch/mobile_internet_report122009.html">five years</a>. Two of the three dominant video game consoles have web browsers (and <a href="http://www.nintendo.com/consumer/systems/wii/en_na/channelsInternet.jsp">one of them</a> is quite excellent). We’re designing for mice and keyboards, for T9 keypads, for handheld game controllers, for touch interfaces. In short, we’re faced with a greater number of devices, input modes, and browsers than ever before.</p>
<p>In recent years, I’ve been meeting with more companies that request “an iPhone website” as part of their project. It’s an interesting phrase: At face value, of course, it speaks to mobile WebKit’s quality as a browser, as well as a powerful business case for thinking beyond the desktop. But as designers, I think we often take comfort in such explicit requirements, as they allow us to compartmentalize the problems before us. We can quarantine the mobile experience on <a href="http://webkit.dailykos.com/">separate</a> <a href="http://m.nytimes.com/">subdomains</a>, spaces distinct and separate from “the non-iPhone website.” But what’s next? An iPad website? An N90 website? Can we really continue to commit to supporting each new user agent with its own bespoke experience? At some point, this starts to feel like a zero sum game. But how can we—and our designs—adapt?</p>
<h2 id="section1">A flexible foundation</h2>
<p>Let’s consider an <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-flexible.html">example design</a>. I’ve built a simple page for a hypothetical magazine; it’s a straightforward two-column layout built on a <a href="http://www.alistapart.com/articles/fluidgrids/">fluid grid</a>, with not a few <a href="http://unstoppablerobotninja.com/entry/fluid-images">flexible images</a> peppered throughout. As a long-time proponent of non-fixed layouts, I’ve long felt they were more “future proof” simply because they were layout agnostic. And to a certain extent, that’s true: flexible designs make no assumptions about a browser window’s width, and adapt beautifully to devices that have portrait and landscape modes.</p>
<a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-flexible.html"><img src="http://d.alistapart.com/responsive-web-design/fig/f-img-default-wide.jpg" alt="" /></a>Huge images are huge. Our layout, flexible though it is, doesn’t respond well to changes in resolution or viewport size.
<p>But no design, fixed or fluid, scales seamlessly beyond the context for which it was originally intended. The <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-flexible.html">example design</a> scales perfectly well as the browser window resizes, but stress points quickly appear at lower resolutions. When viewed at viewport smaller than 800×600, the illustration behind the logo quickly becomes cropped, navigation text can wrap in an unseemly manner, and the images along the bottom become too compact to appear legible. And it’s not just the lower end of the resolution spectrum that’s affected: when viewing the design on a widescreen display, the images quickly grow to unwieldy sizes, crowding out the surrounding context.</p>
<p>In short, our flexible design works well enough in the desktop-centric context for which it was designed, but isn’t optimized to extend far beyond that.</p>
<h2 id="section2">Becoming responsive</h2>
<p>Recently, an emergent discipline called “<dfn>responsive architecture</dfn>” has begun asking how physical spaces can <em>respond</em> to the presence of people passing through them. Through a combination of embedded robotics and tensile materials, architects are experimenting with <a href="http://robotecture.com/bubble/">art installations</a> and <a href="http://vimeo.com/4661618">wall structures</a> that bend, flex, and expand as crowds approach them. Motion sensors can be paired with climate control systems to adjust a room’s temperature and ambient lighting as it fills with people. Companies have already produced <a href="http://www.smartglassinternational.com/">“smart glass technology” that can automatically become opaque</a> when a room’s occupants reach a certain density threshold, giving them an additional layer of privacy.</p>
<p>In their book <cite>Interactive Architecture</cite>, Michael Fox and Miles Kemp described this more adaptive approach as “a multiple-loop system in which one enters into a conversation; <em>a continual and constructive information exchange</em>.” Emphasis mine, as I think that’s a subtle yet powerful distinction: rather than creating immutable, unchanging spaces that define a particular experience, they suggest inhabitant and structure can—and should—mutually influence each other.</p>
<p>This is our way forward. Rather than tailoring disconnected designs to each of an ever-increasing number of web devices, we can treat them as facets of the same experience. We can design for an optimal viewing experience, but embed standards-based technologies into our designs to make them not only more flexible, but more adaptive to the media that renders them. In short, we need to practice <em>responsive web design</em>. But how?</p>
<h2 id="section3">Meet the media query</h2>
<p>Since the days of <abbr title="Cascading Style Sheets level 2.1">CSS 2.1</abbr>, our style sheets have enjoyed some measure of device awareness through <a href="http://www.w3.org/TR/CSS21/media.html"><dfn>media types</dfn></a>. If you’ve ever written <a href="http://www.alistapart.com/articles/goingtoprint/">a print style sheet</a>, you’re already familiar with the concept:</p>
<pre id="snippet1" class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>core.css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>screen<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>print.css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>print<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></code></pre>
<p>In the hopes that we’d be designing more than neatly formatted page printouts, the <abbr title="Cascading Style Sheets">CSS</abbr> specification supplied us with a bevy of <a href="http://www.w3.org/TR/CSS21/media.html#media-types">acceptable media types</a>, each designed to target a specific class of web-ready device. But most browsers and devices never really embraced the spirit of the specification, leaving many media types <a href="http://www.alistapart.com/articles/return-of-the-mobile-stylesheet">implemented imperfectly</a>, or altogether ignored.</p>
<p>Thankfully, the <abbr title="World Wide Web Consortium">W3C</abbr> created <a href="http://www.w3.org/TR/css3-mediaqueries/"><dfn>media queries</dfn></a> as part of the <abbr title="Cascading Style Sheets level 3">CSS3</abbr> specification, improving upon the promise of media types. A media query allows us to target not only certain device classes, but to actually inspect the physical characteristics of the device rendering our work. For example, following the recent rise of mobile WebKit, media queries became a popular client-side technique for delivering a tailored style sheet to the iPhone, Android phones, and their ilk. To do so, we could incorporate a query into a <code>link</code>ed style sheet’s <code>media</code> attribute:</p>
<pre id="snippet2" class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>screen and (max-device-width: 480px)<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shetland.css<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></code></pre>
<p>The query contains two components:</p>
<ol>
<li>a media type (<code>screen</code>), and</li>
<li>the actual query enclosed within parentheses, containing a particular <dfn>media feature</dfn> (<code>max-device-width</code>) to inspect, followed by the target value (<code>480px</code>).</li>
</ol>
<p>In plain English, we’re asking the device if its horizontal resolution (<code>max-device-width</code>) is equal to or less than <code>480px</code>. If the test passes—in other words, if we’re viewing our work on a small-screen device like the iPhone—then the device will load <code>shetland.css</code>. Otherwise, the <code>link</code> is ignored altogether.</p>
<p>Designers have experimented with resolution-aware layouts in the past, mostly relying on <abbr title="JavaScript">JS</abbr>-driven solutions like <a href="http://www.themaninblue.com/experiment/ResolutionLayout/">Cameron Adams’ excellent script</a>. But the media query specification provides <a href="http://www.w3.org/TR/css3-mediaqueries/#media1">a host of media features</a> that extends far beyond screen resolution, vastly widening the scope of what we can test for with our queries. What’s more, you can test multiple property values in a single query by chaining them together with the <code>and</code> keyword:</p>
<pre id="snippet3" class=" language-markup"><code class=" language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>screen and (max-device-width: 480px) and (resolution: 163dpi)<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>shetland.css<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span></code></pre>
<p>Furthermore, we’re not limited to incorporating media queries in our <code>link</code>s. We can include them in our <abbr title="Cascading Style Sheets">CSS</abbr> either as part of a <code>@media</code> rule:</p>
<pre id="snippet4" class=" language-css"><code class=" language-css"><span class="token atrule">@media screen and (max-device-width: 480px) </span><span class="token punctuation">{</span> <span class="token selector">.column </span><span class="token punctuation">{</span> <span class="token property">float</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre>
<p>Or as part of an <code>@import</code> directive:</p>
<pre id="snippet5" class=" language-css"><code class=" language-css"><span class="token atrule">@import url("shetland.css") screen and (max-device-width: 480px)</span><span class="token punctuation">;</span></code></pre>
<p>But in each case, the effect is the same: If the device passes the test put forth by our media query, the relevant <abbr title="Cascading Style Sheets">CSS</abbr> is applied to our markup. Media queries are, in short, <a href="http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx">conditional comments</a> for the rest of us. Rather than targeting a specific version of a specific browser, we can surgically correct issues in our layout as it scales beyond its initial, ideal resolution.</p>
<h2 id="section4">Adapt, respond, and overcome</h2>
<p>Let’s turn our attention to the images at the base of our page. In their default layout, the relevant <abbr title="Cascading Style Sheets">CSS</abbr> currently looks like this:</p>
<pre id="snippet6" class=" language-css"><code class=" language-css"><span class="token selector">.figure </span><span class="token punctuation">{</span> <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> 0 3.317535545023696682% 1.5em 0<span class="token punctuation">;</span> <span class="token comment">/* 21px / 633px */</span> <span class="token property">width</span><span class="token punctuation">:</span> 31.121642969984202211%<span class="token punctuation">;</span> <span class="token comment">/* 197px / 633px */</span> <span class="token punctuation">}</span><span class="token selector">li#f-mycroft, li#f-winter </span><span class="token punctuation">{</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre>
<p>I’ve omitted a number of typographic properties to focus on the layout: Each <code>.figure</code> element is sized at roughly one third of the containing column, with the right-hand margin zeroed out for the two pictures at the end of each row (<code>li#f-mycroft, li#f-winter</code>). And this works fairly well, until the viewport is either noticeably smaller or wider than our original design. With media queries, we can apply resolution-specific spotfixes, adapting our design to better respond to changes in the display.</p>
<p>First of all, let’s linearize our page once the viewport falls below a certain resolution threshold—say, <code>600px</code>. So at the bottom of our style sheet, let’s create a new <code>@media</code> block, like so:</p>
<pre id="snippet7" class=" language-css"><code class=" language-css"><span class="token atrule">@media screen and (max-width: 600px) </span><span class="token punctuation">{</span> <span class="token selector">.mast, .intro, .main, .footer </span><span class="token punctuation">{</span> <span class="token property">float</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token property">width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre>
<p>If you view <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-linearize.html">our updated page</a> in a modern desktop browser and reduce the size of your window below <code>600px</code>, the media query will disable the floats on the design’s major elements, stacking each block atop each other in the document flow. So our miniaturized design is shaping up nicely, but the images still don’t scale down that intelligently. If we introduce another media query, we can alter their layout accordingly:</p>
<pre id="snippet8" class=" language-css"><code class=" language-css"><span class="token atrule">@media screen and (max-width: 400px) </span><span class="token punctuation">{</span> <span class="token selector">.figure, li#f-mycroft </span><span class="token punctuation">{</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> 3.317535545023696682%<span class="token punctuation">;</span> <span class="token comment">/* 21px / 633px */</span> <span class="token property">width</span><span class="token punctuation">:</span> 48.341232227488151658%<span class="token punctuation">;</span> <span class="token comment">/* 306px / 633px */</span> <span class="token punctuation">}</span> <span class="token selector">li#f-watson, li#f-moriarty </span><span class="token punctuation">{</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre>
<a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-mini.html"><img src="http://d.alistapart.com/responsive-web-design/fig/f-img-narrow.jpg" alt="" /></a> Our figures can responsively change their layout <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-mini.html">to better suit smaller displays</a>.
<p>Don’t mind the unsightly percentages; we’re simply recalculating the widths of the <a href="http://www.alistapart.com/articles/fluidgrids/">fluid grid</a> to account for the newly linearized layout. In short, we’re <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-mini.html">moving from a three-column layout to a two-column layout</a> when the viewport’s width falls below <code>400px</code>, making the images more prominent.</p>
<p>We can actually take the same approach for widescreen displays, too. For larger resolutions, we could adopt a six-across treatment for our images, placing them <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-larger.html">all in the same row</a>:</p>
<pre id="snippet9" class=" language-css"><code class=" language-css"><span class="token atrule">@media screen and (min-width: 1300px) </span><span class="token punctuation">{</span> <span class="token selector">.figure, li#f-mycroft </span><span class="token punctuation">{</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> 3.317535545023696682%<span class="token punctuation">;</span> <span class="token comment">/* 21px / 633px */</span> <span class="token property">width</span><span class="token punctuation">:</span> 13.902053712480252764%<span class="token punctuation">;</span> <span class="token comment">/* 88px / 633px */</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code></pre>
<p>Now our images are working beautifully <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-larger.html">at both ends of the resolution spectrum</a>, optimizing their layout to changes in window widths and device resolution alike.</p>
<a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-larger.html"><img src="http://d.alistapart.com/responsive-web-design/fig/f-img-widescreen.jpg" alt="" /></a> By specifying a wider <code>min-width</code> in a new media query, we can shift our images into <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-larger.html">a single row layout</a>.
<p>But this is only the beginning. Working from the media queries we’ve embedded in our <abbr title="Cascading Style Sheets">CSS</abbr>, we can alter much more than the placement of a few images: we can <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-FINAL.html">introduce new, alternate layouts</a> tuned to each resolution range, perhaps making the navigation more prominent in a widescreen view, or repositioning it above the logo on smaller displays.</p>
<a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-FINAL.html"><img src="http://d.alistapart.com/responsive-web-design/fig/f-nav-narrow.jpg" alt="" /></a> By designing responsively, we can not only linearize our content on smaller devices, but also <a href="http://d.alistapart.com/responsive-web-design/ex/ex-site-FINAL.html">optimize its presentation across a range of displays</a>.
<p>But a responsive design isn’t limited to layout changes. Media queries allow us to practice some incredibly precise fine-tuning as our pages reshape themselves: we can increase the target area on links for smaller screens, better complying with <a href="http://en.wikipedia.org/wiki/Fitts'_law">Fitts’ Law</a> on touch devices; selectively show or hide elements that might enhance a page’s navigation; we can even practice <a href="http://d.alistapart.com/responsive-web-design/ex/ex-article.html">responsive typesetting</a> to gradually alter the size and leading of our text, optimizing the reading experience for the display providing it.</p>
<h3 id="section5">A few technical notes</h3>
<p>It should be noted that media queries enjoy incredibly robust support among modern browsers. Desktop browsers such as Safari 3+, Chrome, Firefox 3.5+, and Opera 7+ all natively parse media queries, as do more recent mobile browsers such as Opera Mobile and mobile WebKit. Of course, older versions of those desktop browsers don’t support media queries. And while Microsoft has committed to <a title="Internet Explorer version 9" href="http://ie.microsoft.com/testdrive/HTML5/85CSS3_MediaQueries/Default.html">media query support in <abbr title="Internet Explorer version 9">IE9</abbr></a>, Internet Explorer currently doesn’t offer a native implementation.</p>
<p>However, if you’re interested in implementing legacy browser support for media queries, there’s a JavaScript-tinted silver lining:</p>
<ul>
<li><a href="http://plugins.jquery.com/project/MediaQueries">A jQuery plugin</a> from 2007 offers somewhat limited media query support, implementing only the <code>min-width</code> and <code>max-width</code> media properties when attached to separate <code>link</code>elements.</li>
<li>More recently, <a href="http://code.google.com/p/css3-mediaqueries-js/">css3-mediaqueries.js</a> was released, a library that promises “to make <abbr title="Internet Explorer version 5">IE 5</abbr>+, Firefox 1+ and Safari 2 transparently parse, test, and apply <abbr title="Cascading Style Sheets level 3">CSS3</abbr> Media Queries” when included via <code>@media</code> blocks. While very much a 1.0 release, I’ve personally found it to be quite robust, and I plan to watch its development.</li>
</ul>
<p>But if using JavaScript doesn’t appeal, that’s perfectly understandable. However, that strengthens the case for building your layout atop a <a href="http://www.alistapart.com/articles/fluidgrids/">flexible grid</a>, ensuring your design enjoys some measure of flexibility in media query-blind browsers and devices.</p>
</div>